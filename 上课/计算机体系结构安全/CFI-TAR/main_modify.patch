--- qemu-2.7.0/linux-user/main.c	2016-09-02 11:34:22.000000000 -0400
+++ homesrc/main.c	2018-04-10 23:29:16.196536012 -0400
@@ -49,6 +49,9 @@ unsigned long mmap_min_addr;
 unsigned long guest_base;
 int have_guest_base;
 
+/* QEMU-HOMEWORK CFI-target, command line options */
+int coarsecfi_enabled;
+
 #define EXCP_DUMP(env, fmt, ...)                                        \
 do {                                                                    \
     CPUState *cs = ENV_GET_CPU(env);                                    \
@@ -4010,6 +4013,11 @@ static void handle_arg_trace(const char
     g_free(trace_file);
     trace_file = trace_opt_parse(arg);
 }
+/* QEMU-HOMEWORK CFI-target */
+static void handle_COARSE_CFI_enable(const char *arg)
+{
+	coarsecfi_enabled = 1;
+}
 
 struct qemu_argument {
     const char *argv;
@@ -4062,6 +4070,8 @@ static const struct qemu_argument arg_ta
      "",           "[[enable=]<pattern>][,events=<file>][,file=<file>]"},
     {"version",    "QEMU_VERSION",     false, handle_arg_version,
      "",           "display version information and exit"},
+    {"enable-coarse-CFI",    "",     false, handle_COARSE_CFI_enable,
+     "",    "enable Coarse-grained CFI mechanism"},
     {NULL, NULL, false, NULL, NULL, NULL}
 };
 
@@ -4811,6 +4821,7 @@ int main(int argc, char **argv, char **e
         gdb_handlesig(cpu, 0);
     }
     trace_init_vcpu_events();
+    /*This is CFI-target*/
     cpu_loop(env);
     /* never exits */
     return 0;
